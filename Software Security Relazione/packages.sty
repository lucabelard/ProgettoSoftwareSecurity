% ... (previous imports) ...
\usepackage[english,italian]{babel}
% ... (encoding, fonts, etc.) ...
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{bookmark} % Recommended to fix pdfTeX warning
\usepackage{eurosym}
\usepackage{makeidx}
\makeindex
\usepackage[acronym]{glossaries}
\makeglossaries
\usepackage[square,sort]{natbib}
\usepackage[hyperpageref]{backref}
\renewcommand{\backref}[1]{}
\renewcommand*{\backreftwosep}{ e~}
\renewcommand*{\backreflastsep}{ e~}
\renewcommand*{\backrefalt}[4]{\ifcase #1 \relax \or (Cited at page~#2) \else (Cited at pages~#2) \fi}

% MATHS
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\numberwithin{equation}{section}
\usepackage{numprint}
\usepackage{mathcomp}
\usepackage{gensymb}
\newcommand{\ud}{\mathop{}\ \mathrm{d}}
\usepackage{mathtools}
\DeclarePairedDelimiter{\abs}{\lvert}{\rvert}

% IMAGES
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{arrows,decorations,backgrounds}
\graphicspath{{frontmatter/images/},{chapter1/images/},{chapter8/images/}}
\usepackage{wrapfig}

% TABLES
\usepackage{array}
\usepackage{booktabs}
\usepackage[font=small,format=hang,labelfont={sf,bf}]{caption}
\captionsetup[table]{position=top}
\usepackage{colortbl}
\newcolumntype{G}{>{\columncolor[gray]{0.8}}c} 
\usepackage{xcolor} 
\usepackage{rotating}
\usepackage{multirow}
\usepackage{tabularx}

% GENERAL SETTINGS
\usepackage{mathpazo}
\usepackage[scaled=0.95]{helvet}
\usepackage{courier}
\usepackage[a4paper,top=3.0cm,bottom=2.5cm,left=2.0cm,right=2.0cm,bindingoffset=15mm,marginpar=1.5cm,reversemp]{geometry}
\usepackage{chngpage}
\usepackage{eso-pic}
\newcommand \InMiddlePage [1]{ \AddToShipoutPicture *{\AtPageCenter {\makebox (0 ,100){\includegraphics [ width =0.6\paperwidth ]{#1}}}}}
\newenvironment{abstract}{\null \vfill \begin{center} \bfseries \abstractname \end{center}}{\vfill \null }
\newenvironment{preamble}{\begin{quotation}\footnotesize}{\end{quotation}}
\newenvironment{law}{\begin{quote} \begin{itshape}}{\end{itshape} \end{quote}}

\makeatletter
\def\cleardoublepage{\clearpage \if@twoside \ifodd\c@page \else \null\thispagestyle{empty}\clearpage \fi \fi}
\makeatother

\usepackage{fancyhdr}
\pagestyle{fancy} 
\fancyhead[R]{\bfseries \thepage}
\fancyhead[L]{\slshape \rightmark}
\fancyfoot[C]{}
\renewcommand{\footrulewidth}{0.0pt}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\chaptermark}[1]{\markboth{\thechapter\ $\:-\:$ #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\S \thesection\ $\,-\,$ #1}}

\usepackage[Sonny]{fncychap}
\usepackage[italian]{varioref}
\usepackage{indentfirst}
\usepackage{microtype}
\frenchspacing
\usepackage{enumerate}
\usepackage{comment}
\usepackage[colorlinks=true,hyperindex,pagebackref]{hyperref}
\hypersetup{
    pdftitle={Software Security Relazione},
    pdfsubject={Progetto Software Security},
    pdfauthor={Luca Belardinelli, Luigi Greco},
    pdfkeywords={blockchain, security, smart contracts},
    colorlinks=true,
    linkcolor=black,
    anchorcolor=black,
    citecolor=black,
    filecolor=black,
    menucolor=black,
    runcolor=black,
    urlcolor=black,
    breaklinks=true
}
\usepackage{subfig}

% CODE LISTINGS
\usepackage{listings}
\usepackage{xcolor}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\scriptsize, % Reduced font size
    breakatwhitespace=false,         
    breaklines=true,                 
    postbreak=\mbox{\textcolor{red}{$\hookrightarrow$}\space}, % Arrow for wrapped lines
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    literate={à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1 % UTF8 support
}

\lstset{style=mystyle}
